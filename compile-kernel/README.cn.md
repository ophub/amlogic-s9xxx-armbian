# å†…æ ¸ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜

æŸ¥çœ‹è‹±æ–‡è¯´æ˜ | [View English description](README.md)

æ­¤å†…æ ¸å¯ç”¨äº `Armbian` å’Œ `OpenWrt` ç³»ç»Ÿã€‚ä¾‹å¦‚ [amlogic-s9xxx-armbian](https://github.com/ophub/amlogic-s9xxx-armbian), [amlogic-s9xxx-openwrt](https://github.com/ophub/amlogic-s9xxx-openwrt), [flippy-openwrt-actions](https://github.com/ophub/flippy-openwrt-actions) å’Œ [unifreq/openwrt_packit](https://github.com/unifreq/openwrt_packit) ç­‰é¡¹ç›®ã€‚å¯ä»¥åœ¨ç¼–è¯‘å›ºä»¶æ—¶é›†æˆï¼Œä¹Ÿå¯ä»¥å®‰è£…åˆ°å·²æœ‰çš„ç³»ç»Ÿä¸­ä½¿ç”¨ã€‚

ä½ å¯ä»¥æ ¹æ®éœ€è¦å¯¹å†…æ ¸çš„é…ç½®è¿›è¡Œè°ƒæ•´ï¼Œå¦‚æ·»åŠ é©±åŠ¨å’Œè¡¥ä¸ã€‚ä¹Ÿå¯ä»¥æ ¹æ®å¿ƒæƒ…ç¼–è¯‘å…·æœ‰ç‰¹æ®Šæ„ä¹‰çš„ä¸ªæ€§åŒ–ç­¾åå†…æ ¸ï¼Œå¦‚ `5.10.95-happy-new-year`, `5.10.96-beijing-winter-olympics`, `5.10.99-valentines-day` ç­‰ç­‰ã€‚

## å†…æ ¸å­˜å‚¨åº“

åœ¨ [ophub/kernel](https://github.com/ophub/kernel) çš„ [Releases](https://github.com/ophub/kernel/releases) é‡Œæœ‰å·²ç»ç¼–è¯‘å¥½çš„å†…æ ¸ã€‚

## æœ¬åœ°ç¼–è¯‘

- ### åœ¨ Ubuntu ç³»ç»Ÿä¸‹è¿è¡Œ

1. å…‹éš†ä»“åº“åˆ°æœ¬åœ° `git clone --depth 1 https://github.com/ophub/amlogic-s9xxx-armbian.git`

2. å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…ï¼ˆè„šæœ¬ä»…åœ¨ x86_64 Ubuntu-20.04/22.04 ä¸‹åšè¿‡æµ‹è¯•ï¼‰

```yaml
sudo apt-get update -y
sudo apt-get full-upgrade -y
# For Ubuntu-22.04
sudo apt-get install -y $(cat compile-kernel/tools/script/ubuntu2204-build-armbian-depends)
```

3. è¿›å…¥ `~/amlogic-s9xxx-armbian` æ ¹ç›®å½•ï¼Œç„¶åè¿è¡Œ `sudo ./recompile -k 5.15.100` ç­‰æŒ‡å®šå‚æ•°å‘½ä»¤å³å¯ç¼–è¯‘å†…æ ¸ã€‚è„šæœ¬ä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…ç¼–è¯‘ç¯å¢ƒå’Œå†…æ ¸æºç å¹¶åšå¥½å…¨éƒ¨è®¾ç½®ã€‚æ‰“åŒ…å¥½çš„å†…æ ¸æ–‡ä»¶ä¿å­˜åœ¨ `compile-kernel/output` ç›®å½•é‡Œã€‚

- ### åœ¨ Armbian ç³»ç»Ÿä¸‹è¿è¡Œ

1. æ›´æ–°æœ¬åœ°ç¼–è¯‘ç¯å¢ƒå’Œé…ç½®æ–‡ä»¶ï¼š`armbian-kernel -u`

2. ç¼–è¯‘å†…æ ¸ï¼šè¿è¡Œ `armbian-kernel -k 5.15.100` ç­‰æŒ‡å®šå‚æ•°å‘½ä»¤å³å¯ç¼–è¯‘å†…æ ¸ã€‚è„šæœ¬ä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…ç¼–è¯‘ç¯å¢ƒå’Œå†…æ ¸æºç å¹¶åšå¥½å…¨éƒ¨è®¾ç½®ã€‚æ‰“åŒ…å¥½çš„å†…æ ¸æ–‡ä»¶ä¿å­˜åœ¨ `/opt/kernel/compile-kernel/output` ç›®å½•é‡Œã€‚

- ### æœ¬åœ°ç¼–è¯‘å‚æ•°è¯´æ˜

| å‚æ•°    | å«ä¹‰        | è¯´æ˜                             |
| ------ | ----------- | ------------------------------- |
| -r     | Repository  | æŒ‡å®šç¼–è¯‘å†…æ ¸çš„æºä»£ç ä»“åº“ã€‚å¯é€‰æ‹© `github.com` çš„å†…æ ¸æºä»£ç ä»“åº“ã€‚ä¾‹å¦‚ `-r unifreq` ç­‰ã€‚å¯è®¾ç½®å‚æ•°æ ¼å¼ä¸º `owner/repo@branch` ä¸‰é¡¹ç»„åˆï¼Œå‚æ•°ä¸­çš„æ‰€æœ‰è€…åç§° `owner` ä¸ºå¿…é€‰å‚æ•°ï¼Œå†…æ ¸æºä»£ç ä»“åº“åç§° `/repo` å’Œ ä»“åº“çš„åˆ†æ”¯åç§° `@branch` ä¸ºå¯é€‰å‚æ•°ã€‚å½“ä»…æŒ‡å®šæ‰€æœ‰è€…åç§° `owner` å‚æ•°æ—¶ï¼Œå°†è‡ªåŠ¨åŒ¹é…æ‰€æœ‰è€…çš„åç§°ä¸º `linux-5.x.y` æ ¼å¼ä¸”åˆ†æ”¯ä¸º `main` çš„å†…æ ¸æºä»£ç ä»“åº“ã€‚å¦‚æœä»“åº“åç§°æˆ–åˆ†æ”¯åç§°ä¸åŒï¼Œè¯·ä½¿ç”¨ç»„åˆæ–¹å¼æŒ‡å®šï¼Œå¦‚ `owner@branch` æˆ– `owner/repo` æˆ– `owner/repo@branch`ã€‚é»˜è®¤å€¼ï¼š`unifreq` |
| -k     | Kernel      | æŒ‡å®š kernel åç§°ï¼Œå¦‚ `-k 5.15.100` . å¤šä¸ªå†…æ ¸ä½¿ç”¨ `_` è¿›è¡Œè¿æ¥ï¼Œå¦‚ `-k 5.15.100_5.15.50` |
| -a     | AutoKernel  | è®¾ç½®æ˜¯å¦è‡ªåŠ¨é‡‡ç”¨åŒç³»åˆ—æœ€æ–°ç‰ˆæœ¬å†…æ ¸ã€‚å½“ä¸º `true` æ—¶ï¼Œå°†è‡ªåŠ¨æŸ¥æ‰¾åœ¨ `-k` ä¸­æŒ‡å®šçš„å†…æ ¸å¦‚ `5.15.100` çš„åŒç³»åˆ—æ˜¯å¦æœ‰æ›´æ–°çš„ç‰ˆæœ¬ï¼Œå¦‚æœ‰ `5.15.100` ä¹‹åçš„æœ€æ–°ç‰ˆæœ¬æ—¶ï¼Œå°†è‡ªåŠ¨æ›´æ¢ä¸ºæœ€æ–°ç‰ˆã€‚è®¾ç½®ä¸º `false` æ—¶å°†ç¼–è¯‘æŒ‡å®šç‰ˆæœ¬å†…æ ¸ã€‚é»˜è®¤å€¼ï¼š`true` |
| -m     | MakePackage | è®¾ç½®åˆ¶ä½œå†…æ ¸çš„åŒ…åˆ—è¡¨ã€‚å½“è®¾ç½®ä¸º `all` ï¼Œå°†åˆ¶ä½œ `Image, modules, dtbs` çš„å…¨éƒ¨æ–‡ä»¶ã€‚å½“è®¾ç½®å€¼ä¸º `dtbs` æ—¶ä»…åˆ¶ä½œ 3 ä¸ª dtbs æ–‡ä»¶ã€‚é»˜è®¤å€¼ï¼š`all` |
| -p     | AutoPatch   | è®¾ç½®æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰å†…æ ¸è¡¥ä¸ã€‚å½“è®¾ç½®ä¸º `true` æ—¶å°†ä½¿ç”¨ [tools/patch](tools/patch) ç›®å½•ä¸‹çš„å†…æ ¸è¡¥ä¸ï¼Œè¯¦ç»†è¯´æ˜å‚è€ƒ[å†…æ ¸è¡¥ä¸æ·»åŠ æ–¹æ³•](../documents/README.cn.md#9-ç¼–è¯‘-armbian-å†…æ ¸)ã€‚é»˜è®¤å€¼ï¼š`false` |
| -n     | CustomName  | è®¾ç½®å†…æ ¸è‡ªå®šä¹‰ç­¾åã€‚å½“è®¾ç½®ä¸º `-ophub` ï¼Œç”Ÿæˆçš„å†…æ ¸åç§°ä¸º `5.15.100-ophub` ã€‚è®¾ç½®è‡ªå®šä¹‰ç­¾åæ—¶è¯·å‹¿åŒ…å«ç©ºæ ¼ã€‚é»˜è®¤å€¼ï¼š`-ophub` |
| -t     | Toolchain   | è®¾ç½®ç¼–è¯‘å†…æ ¸çš„å·¥å…·é“¾ã€‚å¯é€‰é¡¹ï¼š`clang / gcc`ã€‚é»˜è®¤å€¼ï¼š`gcc` |

- `sudo ./recompile` : ä½¿ç”¨é»˜è®¤é…ç½®ç¼–è¯‘å†…æ ¸ã€‚
- `sudo ./recompile -k 5.15.100` : ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå¹¶é€šè¿‡ `-k` è¿›è¡ŒæŒ‡å®šéœ€è¦ç¼–è¯‘çš„å†…æ ¸ç‰ˆæœ¬ï¼Œå¤šä¸ªç‰ˆæœ¬åŒæ—¶ç¼–è¯‘æ—¶ä½¿ç”¨ `_` è¿›è¡Œè¿æ¥ã€‚
- `sudo ./recompile -k 5.15.100 -a true` : ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå¹¶é€šè¿‡ `-a` å‚æ•°è®¾ç½®ç¼–è¯‘å†…æ ¸æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨å‡çº§åˆ°åŒç³»åˆ—æœ€æ–°å†…æ ¸ã€‚
- `sudo ./recompile -k 5.15.100 -n -ophub` : ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå¹¶é€šè¿‡ `-n` å‚æ•°è®¾ç½®å†…æ ¸è‡ªå®šä¹‰ç­¾åã€‚
- `sudo ./recompile -k 5.15.100 -m dtbs` : ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå¹¶é€šè¿‡ `-m` å‚æ•°æŒ‡å®šä»…åˆ¶ä½œ dtbs æ–‡ä»¶ã€‚
- `sudo ./recompile -k 5.15.100_6.1.10 -a true -n -ophub` : ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œå¹¶é€šè¿‡å¤šä¸ªå‚æ•°è¿›è¡Œè®¾ç½®ã€‚

ğŸ’¡æç¤ºï¼šæ¨èä½¿ç”¨ `unifreq` çš„ [linux-6.1.y](https://github.com/unifreq/linux-6.1.y), [linux-5.15.y](https://github.com/unifreq/linux-5.15.y), [linux-5.10.y](https://github.com/unifreq/linux-5.10.y) å’Œ [linux-5.4.y](https://github.com/unifreq/linux-5.4.y) ç­‰ä»“åº“çš„å†…æ ¸æºä»£ç è¿›è¡Œç¼–è¯‘ï¼Œä»–é’ˆå¯¹ç›¸å…³ç›’å­æ·»åŠ äº†é©±åŠ¨å’Œè¡¥ä¸ã€‚æ¨èä½¿ç”¨ [tools/config](tools/config) ä¸­çš„æ¨¡æ¿ï¼Œå·²ç»æ ¹æ®ç›¸å…³ç›’å­è¿›è¡Œäº†é¢„é…ç½®ï¼Œå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œä¸ªæ€§åŒ–å®šåˆ¶ã€‚

## ä½¿ç”¨ GitHub Actions ç¼–è¯‘å†…æ ¸

1. åœ¨ [Action](https://github.com/ophub/amlogic-s9xxx-armbian/actions) é¡µé¢é‡Œé€‰æ‹© ***`Compile the kernel`*** ï¼Œç‚¹å‡» ***`Run workflow`*** æŒ‰é’®å³å¯ç¼–è¯‘ã€‚

2. è¯¦è§ä½¿ç”¨æ¨¡æ¿ [compile-kernel.yml](../.github/workflows/compile-kernel.yml) ã€‚ä»£ç å¦‚ä¸‹:

```yaml
- name: Compile the kernel
  uses: ophub/amlogic-s9xxx-armbian@main
  with:
    build_target: kernel
    kernel_version: 5.15.1_6.1.1
    kernel_auto: true
    kernel_sign: -yourname
```

ğŸ’¡æ³¨æ„: å¦‚æœä½  `fork` ä»“åº“å¹¶è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½¿ç”¨æ—¶é¡»å°† Actions çš„ `ç”¨æˆ·å` æ”¹æˆä½ è‡ªå·±çš„ä»“åº“ï¼Œå¹¶æ ¹æ®è¯´æ˜ä¸­çš„ç¬¬ 2-3 æ¡ [æ·»åŠ  TOKEN](../documents/README.cn.md#2-è®¾ç½®éšç§å˜é‡-github_token)ï¼Œä¾‹å¦‚ï¼š

```yaml
uses: YOUR-REPO/amlogic-s9xxx-armbian@main
```

- ### GitHub Action è¾“å…¥å‚æ•°è¯´æ˜

ç›¸å…³å‚æ•°ä¸`æœ¬åœ°ç¼–è¯‘å‘½ä»¤`ç›¸å¯¹åº”ï¼Œè¯·å‚è€ƒä¸Šé¢çš„è¯´æ˜ã€‚

| å‚æ•°               | é»˜è®¤å€¼            | è¯´æ˜                                                      |
|-------------------|------------------|-----------------------------------------------------------|
| build_target      | kernel           | å›ºå®šå‚æ•° `kernel`ï¼Œè®¾ç½®ç¼–è¯‘ç›®æ ‡ä¸ºå†…æ ¸ã€‚                        |
| kernel_source     | unifreq          | æŒ‡å®šç¼–è¯‘å†…æ ¸çš„æºä»£ç ä»“åº“ã€‚é»˜è®¤å€¼ä¸º `unifreq` ã€‚åŠŸèƒ½å‚è€ƒ `-r`      |
| kernel_version    | 5.15.1_6.1.1     | æŒ‡å®š kernel åç§°ï¼Œå¦‚ `5.15.100`ã€‚åŠŸèƒ½å‚è€ƒ `-k`                |
| kernel_auto       | true             | è®¾ç½®æ˜¯å¦è‡ªåŠ¨é‡‡ç”¨åŒç³»åˆ—æœ€æ–°ç‰ˆæœ¬å†…æ ¸ã€‚é»˜è®¤å€¼ä¸º `true`ã€‚åŠŸèƒ½å‚è€ƒ `-a`  |
| kernel_package    | all              | è®¾ç½®åˆ¶ä½œå†…æ ¸çš„åŒ…åˆ—è¡¨ã€‚é»˜è®¤å€¼ä¸º `all`ã€‚åŠŸèƒ½å‚è€ƒ `-m`             |
| kernel_sign       | -ophub           | è®¾ç½®å†…æ ¸è‡ªå®šä¹‰ç­¾åã€‚é»˜è®¤å€¼ä¸º `-ophub`ã€‚åŠŸèƒ½å‚è€ƒ `-n`             |
| kernel_toolchain  | gcc              | è®¾ç½®ç¼–è¯‘å†…æ ¸çš„å·¥å…·é“¾ã€‚é»˜è®¤å€¼ä¸º `gcc`ã€‚åŠŸèƒ½å‚è€ƒ `-t`             |
| kernel_config     | false            | é»˜è®¤ä½¿ç”¨ [tools/config](tools/config) ç›®å½•ä¸‹çš„é…ç½®æ¨¡æ¿ã€‚ä½ å¯ä»¥è®¾ç½®ç¼–è¯‘å†…æ ¸çš„é…ç½®æ–‡ä»¶åœ¨ä½ ä»“åº“ä¸­çš„å­˜æ”¾ç›®å½•ï¼Œå¦‚ `kernel/config_path` ã€‚è¯¥ç›®å½•ä¸‹å­˜å‚¨çš„é…ç½®æ¨¡æ¿å¿…é¡»ä»¥å†…æ ¸çš„ä¸»ç‰ˆæœ¬å‘½åï¼Œå¦‚`config-5.10`ã€`config-5.15`ç­‰ã€‚ |
| kernel_patch      | false            | è®¾ç½®è‡ªå®šä¹‰å†…æ ¸è¡¥ä¸ç›®å½•ã€‚ |
| auto_patch        | false            | è®¾ç½®æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰å†…æ ¸è¡¥ä¸ã€‚é»˜è®¤å€¼ä¸º `false`ã€‚åŠŸèƒ½å‚è€ƒ `-p` |

- ### GitHub Action è¾“å‡ºå˜é‡è¯´æ˜

ä¸Šä¼ åˆ° `Releases` éœ€è¦ç»™ä»“åº“æ·»åŠ  `GITHUB_TOKEN` å’Œ `GH_TOKEN` å¹¶è®¾ç½® `Workflow è¯»å†™æƒé™`ï¼Œè¯¦è§[ä½¿ç”¨è¯´æ˜](../documents/README.cn.md#2-è®¾ç½®éšç§å˜é‡-github_token)ã€‚

| å‚æ•°                               | é»˜è®¤å€¼                    | è¯´æ˜                       |
|-----------------------------------|--------------------------|----------------------------|
| ${{ env.PACKAGED_OUTPUTTAGS }}    | 5.15.1_6.1.1             | ç¼–è¯‘å¥½çš„å†…æ ¸çš„åç§°            |
| ${{ env.PACKAGED_OUTPUTPATH }}    | compile-kernel/output    | ç¼–è¯‘å®Œæˆçš„å†…æ ¸æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„  |
| ${{ env.PACKAGED_OUTPUTDATE }}    | 04.13.1058               | ç¼–è¯‘æ—¥æœŸï¼ˆæœˆ.æ—¥.æ—¶åˆ†ï¼‰        |
| ${{ env.PACKAGED_STATUS }}        | success                  | ç¼–è¯‘çŠ¶æ€ï¼šsuccess / failure  |

## å†…æ ¸ä½¿ç”¨è¯´æ˜

æ­¤å†…æ ¸å¯ç”¨äº `Armbian` å’Œ `OpenWrt` ç³»ç»Ÿã€‚ä»¥ ophub çš„é¡¹ç›®è¿›è¡Œä¸¾ä¾‹è¯´æ˜ã€‚

### åœ¨ Armbian ç³»ç»Ÿä¸­ä½¿ç”¨

ä¸‹é¢åˆ†åˆ«å¯¹åœ¨ç¼–è¯‘ Armbian å›ºä»¶æ—¶é›†æˆï¼Œä»¥åŠå¦‚ä½•å®‰è£…åˆ°å·²æœ‰çš„ç³»ç»Ÿä¸­ä½¿ç”¨è¿›è¡Œè¯´æ˜ã€‚

- #### ä½¿ç”¨å†…æ ¸ç¼–è¯‘ Armbian å›ºä»¶

ç¼–è¯‘ Armbian å›ºä»¶æ”¯æŒæœ¬åœ°åŒ–æ“ä½œï¼Œä¹Ÿæ”¯æŒä½¿ç”¨ github.com çš„ Actions åœ¨çº¿ç¼–è¯‘ã€‚å…¶ä¸­æœ¬åœ°åŒ–ç¼–è¯‘æ—¶çš„ä½¿ç”¨æ–¹æ³•è¯¦è§ï¼š[æœ¬åœ°åŒ–æ‰“åŒ…](../README.cn.md#æœ¬åœ°åŒ–æ‰“åŒ…), ä½¿ç”¨ Actions åœ¨çº¿ç¼–è¯‘çš„æ–¹æ³•è¯¦è§ï¼š[ä½¿ç”¨ GitHub Actions è¿›è¡Œç¼–è¯‘](../README.cn.md#ä½¿ç”¨-github-actions-è¿›è¡Œç¼–è¯‘)

- #### å°†å†…æ ¸å®‰è£…åˆ°å·²æœ‰çš„ Armbian ç³»ç»Ÿ

å¯ä»¥ä½¿ç”¨ `armbian-update` å‘½ä»¤å°†ç¼–è¯‘å¥½çš„å†…æ ¸å®‰è£…åˆ°å·²æœ‰çš„ Armbian ç³»ç»Ÿä¸­ï¼Œå…·ä½“æ“ä½œæ–¹æ³•è¯¦è§ï¼š[æ›´æ–° Armbian å†…æ ¸](../README.cn.md#æ›´æ–°-armbian-å†…æ ¸)


### åœ¨ OpenWrt ç³»ç»Ÿä¸­ä½¿ç”¨

ä¸‹é¢åˆ†åˆ«å¯¹åœ¨ OpenWrt ç³»ç»Ÿä¸­ç¼–è¯‘å›ºä»¶æ—¶é›†æˆå’Œå®‰è£…åˆ°å·²æœ‰çš„ç³»ç»Ÿä¸­ä½¿ç”¨è¿›è¡Œä»‹ç»ã€‚

- #### ä½¿ç”¨å†…æ ¸ç¼–è¯‘ OpenWrt å›ºä»¶

ç¼–è¯‘ OpenWrt å›ºä»¶æ”¯æŒæœ¬åœ°åŒ–æ“ä½œï¼Œä¹Ÿæ”¯æŒä½¿ç”¨ github.com çš„ Actions åœ¨çº¿ç¼–è¯‘ã€‚å…¶ä¸­æœ¬åœ°åŒ–ç¼–è¯‘æ—¶çš„ä½¿ç”¨æ–¹æ³•è¯¦è§ï¼š[æœ¬åœ°åŒ–æ‰“åŒ…](https://github.com/ophub/amlogic-s9xxx-openwrt/blob/main/README.cn.md#æœ¬åœ°åŒ–æ‰“åŒ…), ä½¿ç”¨ Actions åœ¨çº¿ç¼–è¯‘çš„æ–¹æ³•è¯¦è§ï¼š[ä½¿ç”¨ Github Actions è¿›è¡Œç¼–è¯‘](https://github.com/ophub/amlogic-s9xxx-openwrt/blob/main/README.cn.md#ä½¿ç”¨-github-actions-è¿›è¡Œç¼–è¯‘)

- #### å°†å†…æ ¸å®‰è£…åˆ°å·²æœ‰çš„ OpenWrt ç³»ç»Ÿ

å¯ä»¥ä½¿ç”¨ [luci-app-amlogic](https://github.com/ophub/luci-app-amlogic/blob/main/README.cn.md) æ’ä»¶å°†ç¼–è¯‘å¥½çš„å†…æ ¸å®‰è£…åˆ°å·²æœ‰çš„ OpenWrt ç³»ç»Ÿä¸­ï¼Œå…·ä½“æ“ä½œæ–¹æ³•è¯¦è§ï¼š[å‡çº§ OpenWrt](https://github.com/ophub/amlogic-s9xxx-openwrt/blob/main/README.cn.md#å‡çº§-openwrt)


